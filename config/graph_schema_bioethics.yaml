# =============================================================================
# Graph Schema Configuration - Bioéthique & Questions de Vie
# =============================================================================
# This schema is tailored for a French Catholic bioethics document corpus
# covering: infertility, miscarriage, contraception, abortion, euthanasia,
# assisted reproduction (PMA), and Church magisterial teachings.
# =============================================================================

# -----------------------------------------------------------------------------
# Domain Description
# -----------------------------------------------------------------------------
domain:
  name: "Bioéthique Catholique"

  description: |
    Corpus de documents en français sur la bioéthique catholique et les questions
    de vie humaine. Les sujets couverts incluent:
    - Bioéthique générale et principes moraux
    - Infertilité et procréation médicalement assistée (PMA)
    - Contraception et régulation des naissances
    - Avortement et début de la vie humaine
    - Euthanasie et fin de vie
    - Fausse couche et accompagnement
    - Enseignements du Magistère de l'Église catholique

    Les documents comprennent des textes magistériels (encycliques, instructions),
    des articles théologiques, des études médicales et éthiques, ainsi que des
    ressources pastorales.

  language: "fr"

  document_types:
    - "magisterial_documents"      # Encycliques, instructions, lettres apostoliques
    - "theological_articles"       # Articles de théologie morale
    - "medical_studies"            # Études médicales et scientifiques
    - "pastoral_resources"         # Ressources d'accompagnement pastoral
    - "ethical_analyses"           # Analyses éthiques et philosophiques
    - "legal_documents"            # Textes juridiques et législatifs

# -----------------------------------------------------------------------------
# Entity Types
# -----------------------------------------------------------------------------
entities:
  # === Concepts médicaux et biologiques ===
  - name: "ConceptMedical"
    description: "Concepts médicaux, biologiques ou scientifiques liés à la vie humaine, la reproduction et la santé"
    examples:
      - "embryon"
      - "fœtus"
      - "gamète"
      - "fécondation in vitro"
      - "ovulation"
      - "implantation"
      - "grossesse"
      - "fertilité"
      - "stérilité"
    attributes:
      - "definition"
      - "domaine_medical"

  # === Concepts éthiques et moraux ===
  - name: "ConceptEthique"
    description: "Principes éthiques, moraux ou philosophiques relatifs à la bioéthique et à la dignité humaine"
    examples:
      - "dignité humaine"
      - "respect de la vie"
      - "loi naturelle"
      - "bien commun"
      - "intention morale"
      - "proportionnalité"
      - "double effet"
      - "consentement éclairé"
    attributes:
      - "definition"
      - "tradition_philosophique"

  # === Concepts théologiques ===
  - name: "ConceptTheologique"
    description: "Concepts théologiques et spirituels liés à la foi catholique et à la morale chrétienne"
    examples:
      - "sacralité de la vie"
      - "création divine"
      - "providence"
      - "péché"
      - "grâce"
      - "vocation"
      - "paternité responsable"
      - "chasteté conjugale"
    attributes:
      - "definition"
      - "source_biblique"

  # === Procédures médicales ===
  - name: "ProcedureMedicale"
    description: "Traitements médicaux, interventions ou procédures liés à la reproduction et à la fin de vie"
    examples:
      - "fécondation in vitro (FIV)"
      - "insémination artificielle"
      - "ICSI"
      - "diagnostic préimplantatoire"
      - "amniocentèse"
      - "interruption volontaire de grossesse"
      - "sédation profonde"
      - "soins palliatifs"
    attributes:
      - "type_intervention"
      - "evaluation_morale"

  # === Méthodes de régulation des naissances ===
  - name: "MethodeContraceptive"
    description: "Méthodes de contraception ou de régulation naturelle des naissances"
    examples:
      - "pilule contraceptive"
      - "stérilet"
      - "préservatif"
      - "méthode Billings"
      - "méthode symptothermique"
      - "continence périodique"
    attributes:
      - "type"
      - "mecanisme_action"
      - "evaluation_morale"

  # === Documents magistériels ===
  - name: "DocumentMagisteriel"
    description: "Textes officiels du Magistère de l'Église catholique (encycliques, instructions, déclarations)"
    examples:
      - "Humanae Vitae"
      - "Evangelium Vitae"
      - "Donum Vitae"
      - "Dignitas Personae"
      - "Veritatis Splendor"
      - "Familiaris Consortio"
    attributes:
      - "type_document"
      - "date_publication"
      - "auteur"

  # === Personnes et autorités ===
  - name: "Personne"
    description: "Personnes mentionnées: papes, théologiens, médecins, saints, auteurs"
    examples:
      - "Pape Jean-Paul II"
      - "Pape Paul VI"
      - "Pape François"
      - "Cardinal Ratzinger"
      - "Saint Thomas d'Aquin"
      - "Jérôme Lejeune"
    attributes:
      - "role"
      - "periode"

  # === Institutions et organisations ===
  - name: "Institution"
    description: "Organisations, institutions ecclésiales ou médicales"
    examples:
      - "Congrégation pour la Doctrine de la Foi"
      - "Académie Pontificale pour la Vie"
      - "Conférence des Évêques de France"
      - "OMS"
      - "Comité Consultatif National d'Éthique"
    attributes:
      - "type"
      - "role"

  # === Situations de vie ===
  - name: "SituationVie"
    description: "Situations existentielles ou conditions de vie concernées par la bioéthique"
    examples:
      - "couple infertile"
      - "grossesse à risque"
      - "fin de vie"
      - "handicap"
      - "fausse couche"
      - "grossesse non désirée"
      - "maladie terminale"
    attributes:
      - "contexte"
      - "accompagnement_pastoral"

  # === Cadre juridique ===
  - name: "CadreJuridique"
    description: "Lois, règlements ou dispositions légales relatives à la bioéthique"
    examples:
      - "loi Veil"
      - "loi de bioéthique"
      - "loi Claeys-Leonetti"
      - "Code de la santé publique"
    attributes:
      - "pays"
      - "date"
      - "disposition_principale"

  # === Arguments et positions ===
  - name: "ArgumentEthique"
    description: "Arguments, objections ou positions éthiques dans les débats bioéthiques"
    examples:
      - "argument de la pente glissante"
      - "objection de conscience"
      - "autonomie du patient"
      - "principe de précaution"
    attributes:
      - "type_argument"
      - "position_defendue"

# -----------------------------------------------------------------------------
# Relationship Types
# -----------------------------------------------------------------------------
relationships:
  # === Relations d'enseignement et d'autorité ===
  - name: "ENSEIGNE"
    description: "Un document ou une personne enseigne/affirme une doctrine ou un principe"
    source_types: ["DocumentMagisteriel", "Personne", "Institution"]
    target_types: ["ConceptEthique", "ConceptTheologique", "ArgumentEthique"]
    examples:
      - "Humanae Vitae ENSEIGNE l'ouverture à la vie"
      - "Jean-Paul II ENSEIGNE la dignité de l'embryon"

  - name: "CONDAMNE"
    description: "Une autorité condamne moralement une pratique ou une position"
    source_types: ["DocumentMagisteriel", "Personne", "Institution"]
    target_types: ["ProcedureMedicale", "MethodeContraceptive", "ConceptEthique"]
    examples:
      - "Evangelium Vitae CONDAMNE l'avortement"
      - "Donum Vitae CONDAMNE la FIV hétérologue"

  - name: "APPROUVE"
    description: "Une autorité approuve ou recommande une pratique ou un principe"
    source_types: ["DocumentMagisteriel", "Personne", "Institution"]
    target_types: ["ProcedureMedicale", "MethodeContraceptive", "ConceptEthique"]
    examples:
      - "Humanae Vitae APPROUVE les méthodes naturelles"
      - "Magistère APPROUVE les soins palliatifs"

  # === Relations conceptuelles ===
  - name: "IMPLIQUE"
    description: "Un concept ou principe implique logiquement un autre"
    source_types: ["ConceptEthique", "ConceptTheologique", "ArgumentEthique"]
    target_types: ["ConceptEthique", "ConceptTheologique", "ArgumentEthique"]
    examples:
      - "Dignité humaine IMPLIQUE respect de la vie"
      - "Loi naturelle IMPLIQUE finalité procréative"

  - name: "CONTREDIT"
    description: "Un concept ou pratique contredit ou s'oppose à un autre"
    source_types: ["ProcedureMedicale", "MethodeContraceptive", "ConceptEthique", "ArgumentEthique"]
    target_types: ["ConceptEthique", "ConceptTheologique", "ArgumentEthique"]
    examples:
      - "Avortement CONTREDIT dignité humaine"
      - "Euthanasie CONTREDIT sacralité de la vie"

  - name: "FONDE"
    description: "Un principe ou concept fonde/justifie un autre"
    source_types: ["ConceptTheologique", "ConceptEthique", "DocumentMagisteriel"]
    target_types: ["ConceptEthique", "ArgumentEthique", "ConceptTheologique"]
    examples:
      - "Création divine FONDE dignité humaine"
      - "Evangelium Vitae FONDE le droit à la vie"

  # === Relations médicales ===
  - name: "TRAITE"
    description: "Une procédure médicale traite ou répond à une situation"
    source_types: ["ProcedureMedicale", "MethodeContraceptive"]
    target_types: ["SituationVie", "ConceptMedical"]
    examples:
      - "FIV TRAITE infertilité"
      - "Soins palliatifs TRAITE fin de vie"

  - name: "PROVOQUE"
    description: "Une procédure ou situation provoque un effet médical ou éthique"
    source_types: ["ProcedureMedicale", "MethodeContraceptive", "SituationVie"]
    target_types: ["ConceptMedical", "SituationVie", "ConceptEthique"]
    examples:
      - "FIV PROVOQUE embryons surnuméraires"
      - "Stérilet PROVOQUE effet anti-nidatoire"

  # === Relations de référence ===
  - name: "CITE"
    description: "Un document cite ou fait référence à un autre"
    source_types: ["DocumentMagisteriel", "Personne"]
    target_types: ["DocumentMagisteriel", "Personne", "ConceptTheologique"]
    examples:
      - "Dignitas Personae CITE Donum Vitae"
      - "Jean-Paul II CITE Saint Thomas"

  - name: "PROMULGUE"
    description: "Une personne ou institution promulgue un document"
    source_types: ["Personne", "Institution"]
    target_types: ["DocumentMagisteriel", "CadreJuridique"]
    examples:
      - "Paul VI PROMULGUE Humanae Vitae"
      - "Parlement PROMULGUE loi bioéthique"

  # === Relations institutionnelles ===
  - name: "MEMBRE_DE"
    description: "Une personne est membre d'une institution"
    source_types: ["Personne"]
    target_types: ["Institution"]
    examples:
      - "Jérôme Lejeune MEMBRE_DE Académie Pontificale pour la Vie"

  - name: "REGULE"
    description: "Un cadre juridique ou institution régule une pratique"
    source_types: ["CadreJuridique", "Institution"]
    target_types: ["ProcedureMedicale", "MethodeContraceptive", "SituationVie"]
    examples:
      - "Loi bioéthique REGULE PMA"
      - "CCNE REGULE recherche sur embryon"

  # === Relations de correspondance ===
  - name: "CONCERNE"
    description: "Un concept, document ou procédure concerne une situation de vie"
    source_types: ["ConceptEthique", "ConceptTheologique", "DocumentMagisteriel", "ProcedureMedicale"]
    target_types: ["SituationVie"]
    examples:
      - "Donum Vitae CONCERNE couple infertile"
      - "Accompagnement CONCERNE fausse couche"

  - name: "ALTERNATIVE_A"
    description: "Une méthode ou procédure est présentée comme alternative à une autre"
    source_types: ["ProcedureMedicale", "MethodeContraceptive"]
    target_types: ["ProcedureMedicale", "MethodeContraceptive"]
    examples:
      - "NaProTechnology ALTERNATIVE_A FIV"
      - "Méthodes naturelles ALTERNATIVE_A contraception"

  - name: "LIEE_A"
    description: "Relation générale entre entités (quand une relation plus spécifique ne s'applique pas)"
    source_types: ["*"]
    target_types: ["*"]
    examples:
      - "Infertilité LIEE_A souffrance"
      - "Avortement LIEE_A contraception"

# -----------------------------------------------------------------------------
# Extraction Settings
# -----------------------------------------------------------------------------
extraction:
  max_entities_per_chunk: 20
  max_relationships_per_chunk: 25
  min_confidence: 0.65
  extract_implicit_relations: true
  resolve_coreferences: true
  extraction_temperature: 0.1

# -----------------------------------------------------------------------------
# Graph Settings
# -----------------------------------------------------------------------------
graph:
  merge_similar_entities: true
  entity_similarity_threshold: 0.82
  enable_communities: true
  community_algorithm: "louvain"
  community_resolution: 1.0
  max_traversal_depth: 4
  generate_community_summaries: true

# -----------------------------------------------------------------------------
# Query Routing Settings
# -----------------------------------------------------------------------------
routing:
  strategy: "hybrid"

  graph_query_patterns:
    - "relation"
    - "lié à"
    - "connecté"
    - "dépend de"
    - "affecte"
    - "impact"
    - "tous les"
    - "toutes les"
    - "combien"
    - "liste"
    - "compare"
    - "différence entre"
    - "enseigne"
    - "condamne"
    - "approuve"
    - "selon"
    - "d'après"
    - "position de"
    - "magistère"
    - "encyclique"

  vector_weight: 0.5
  graph_weight: 0.5
  always_include_vector: true

# -----------------------------------------------------------------------------
# Custom Prompts
# -----------------------------------------------------------------------------
custom_prompts:
  entity_extraction: |
    Tu es un expert en bioéthique catholique. Analyse le texte suivant et extrais les entités pertinentes.

    Domaine: {domain}
    Types d'entités à identifier: {entity_types}

    Texte à analyser:
    {text}

    Pour chaque entité, indique:
    1. Le nom exact tel qu'il apparaît dans le texte
    2. Le type d'entité
    3. Les attributs pertinents

    Sois précis et exhaustif. Inclus les concepts théologiques, éthiques, médicaux,
    les documents magistériels, les personnes et institutions mentionnés.

  relationship_extraction: |
    Tu es un expert en bioéthique catholique. Analyse les relations entre les entités suivantes.

    Entités identifiées: {entities}
    Types de relations possibles: {relationship_types}

    Texte source:
    {text}

    Identifie toutes les relations explicites et implicites entre les entités.
    Porte une attention particulière aux:
    - Relations d'enseignement (qui enseigne quoi)
    - Positions morales (approbation/condamnation)
    - Implications logiques entre concepts
    - Références entre documents

  community_summary: |
    Résume ce groupe d'entités et relations liées à la bioéthique catholique.

    Entités: {entities}
    Relations: {relationships}

    Génère un résumé concis (2-3 phrases) qui capture:
    1. Le thème central du groupe
    2. Les principales positions ou enseignements
    3. Les concepts clés reliés
